\section{ Motivation}

As a result of increasing human population and habitat loss, human-wildlife conflicts have become increasingly common in last several decades\cite{philip-wildlife}.
According to organization The World Wide Fund for Nature (WWF) human-wildlife conflicts are defined as: "any interaction between humans and wildlife that results in negative impacts on human social, economic or cultural life, on the conservation of wildlife populations, or on the environment"\cite{conflict-manual}.
These conflicts range from mostly harmless, non-violent contacts, such as sightings of wildlife animals in urban areas, to destruction of crops and infrastructure, killings of livestock, and in worst cases, losses of human lives.
In more severe cases these conflicts end in defensive or retaliatory killings of wildlife animals which can drive already endangered species to extinction.

Polar bears, tigers and elephants are generally considered to be most problematic \cite{philip-wildlife}.
In Arctic, as a consequence of reduction of their natural habitat, polar bears are drawn to human settlements, food dumps, while searching for food\cite{wildlabs-polarbears}.
Unexpected encounters can turn deadly for for both sides.
As wide ranging animals, tigers need large areas where they can roam, hunt and breed\cite{wildlabs-tigers}.
When their natural prey population is depleted they often turn their attention to poorly protected livestock. 
Their attacks often have economic, social and psychological consequences.
According to WILDLABS, tigers killed 101 people between years 2013 and 2016, in India alone\cite{wildlabs-tigers}.

As herbivores, elephants might be seen as less problematic when compared to polar bears or tigers, but this assumption could not be further from the truth.
Although exact numbers vary between sources, casualties from human-elephant conflicts are much higher compared to conflicts involving polar bears or tigers.
According to WILDLABS, an average of 400 people and 100 elephants are killed every year in India\cite{wildlabs-elephants}. 
Leading cause of death of elephants is electrocution (by electric fences, unprotected power lines), followed by train accidents, poaching and poisoning\cite{cause-of-death}.
One of human-elephant conflict hotspots is in Sonitpur District in Assam province, India. 
In 5300 km\textsuperscript{2} large area around 200,000 people and 200 elephants share the same space\cite{wildlabs-elephants}.
Elephants often venture into paddy fields which represent livelihood for local communities.
A single elephant can quickly trample fields of rice crops in few hours, causing big financial problems to already impoverished farmers\cite{wildlabs-elephants}.

Several measures have been taken to minimize human-elephant conflicts:
\begin{itemize}
    \item Electrical fences, some solar powered, some directly connected to local power lines, latter are deadly for elephants
    \item Watch towers
    \item Trenches
    \item Chilli-based deterrents
    \item Regular patrols
    \item Usage of trained captive elephants to drive wild elephants into the forest
    \item Camera traps with motion sensors
\end{itemize}

Although above mentioned measures function to some degree, they are not effective enough, since they are unreliable or come into effect when the damage has already been done\cite{wildlabs}. 

\section{ Early detection system}

One important component of minimizing human-elephant conflicts is a reliable early detection system. 
System able of detecting presence of nearby elephants would warn nearby communities and give them enough time to prepare and respond nonviolently.
Same kind of system would also provide information about common elephants paths, thus giving farmers knowledge how to better construct and place their fences, barricades, to minimize human-elephant conflict.
System should consist of of several small, deployed devices with mounted cameras, that will detect elephants and one server, which will aggregate alerts and forward them somewhere where local community will see them.
TODO: MAYBE A PICTURE OF SETUP???

Obvious workflow would be that a deployed device makes a picture of its surrounding and sends it over wireless network to main server for processing.
Although most of villages in Sonitpur district have access to cell phones and internet, the connectivity can be unreliable\cite{wildlabs-elephants}. 
Additionally devices will be placed quite far from main server, which makes sending large amount of data a problem. 
This limits choice of wireless networks to long range technologies.
It is therefore preferable that elephant detection is done on deployed device and only results (which can be big few bytes) are send over some radio network to main server.
Deployed devices will be placed in forests, fields, with no access to electricity, therefore they need to be battery powered.
Low maintenance of deployed devices is a desirable quality, which means that they should be functional for longer periods of time without any human interactions.
To achieve that with limited power source, they should be energy efficient, equipped with solar panels and a low power radio.
Device should spent most of their time in sleep mode, conserving energy, only waking up to make a photo, processing it and sending results to main server.
As most of the human-elephant conflicts happen during night\cite{wildlabs-elephants}, thermal camera is needed.

Elephant recognition can be done with a help of convolutional neural network (CNN) running inference on a microcontroller. 
Making this possible and evaluating the solution is the focus of this master's thesis.


\section{ IRNAS and Arribada Initiative}

Above described system is currently in development at IRNAS in collaboration with Arribada Initiative.
Slovenia based Institute IRNAS offers a complete development service, starting with idea on paper and ending with the finished product. 
Its previous projects cover a wide range of different fields, from free space optical systems, bio-printing, to IoT solutions which cover industrial and nature conservative use cases.
Arribada Initiative is a London based team, that uses open source solutions for purposes of nature conservation.
As winner of WWF and WILDLABS Human Widlife Conflict Tech Challenge\cite{wildlabs-winners}, Arribada received funding to develop early detection system.
They spent some time in Assam, India, where they did testing of proof-of-concept design\cite{arribada-assam}.
They decided on devices with thermal cameras, as human-elephant conflicts often happen during the night.
Sensor of choice was FLIR Lepton 2.5 and or 3.5.
They also created large dataset of elephants pictures while filming elephants in Whipsnade's zoo in United Kingdom. 
This dataset will be important for training neural network and it will be discussed in TODO: ADD CHAPTER NUMBER.
To create a final embedded system with on device machine learning, Arribada chose to work with IRNAS.


\section{ Machine learning on embedded devices}

It is worth describing the field of machine learning and its current position in world of small, embedded devices before continuing to objectives of this master's thesis.
We will only mention some high level concepts of machine learning in this section, low level details specific to neural networks will be described in section TODO: ADD SECTION NUMBER.

According to Arthur Samuel (qtd. in Geron \cite{geron}) machine learning is a field of study that gives computers the ability to learn without being explicitly programmed.
This ability to learn is the property of various machine learning algorithms.
We will be using "machine learning" and "learning" terms interchangeably. 
In order to learn, these learning algorithms need to be trained on a collection of examples of some phenomenon\cite{burkovml}. 
These collections are called \textbf{datasets} and can be generated artificially or collected in nature.

An example of a learning algorithm is a system that can predict type of animal movement from an accelerometer sensor.
To train such system, also known as a \textbf{model}, we need expose it to a dataset which would contain accelerometer measurements of different types of movement, such a walking, running, jumping and standing still.
Input to the system could be either raw measurements from all three axis or components extracted from raw measurements such as frequency or amplitude. 
These inputs are also known as \textbf{features}, they are values that describe phenomenon being observed\cite{burkovml}. 
Output of the system would be a predicted type of movement.
Although we would label each example of measurement data what type of movement it represents, we would not directly define the relationship between the two.
Instead we would let the model to figure out connection by itself, through process of training.
Trained model should be general enough so it can correctly predict type of movement on unseen accelerometer data.

There exists a large variety of different learning algorithms. 
Algorithms like K-nearest neighbours, linear and logistic regression, support vector machines fall into category of supervised learning algorithms.
Training data that is fed into them includes solutions, also known as \textbf{labels}\cite{geron}.
Described example would be solved with a supervised learning algorithm.
Algorithms like k-Means, Expectation Maximization, Principal Component Analysis fall into category of unsupervised learning algorithms.
Training data is unlabeled, algorithms are trying to find similarities in data by itself\cite{geron}.
Neural networks, algorithms inspired by neurons in human brains\cite{geron}\cite{cs231n}, can fall into either of categories. 





Describe state of ML in embedded





There is a large variety of different learning algorithms: regression, classification, decision trees, neural networks, etc. 
These algorithms are capable of automating tasks that humans can do instantly, like price predictions, movie genre recommendations, recognition of objects, recognition of outlier values, driving cars and others.
Writing deterministic algorithms for before mentioned tasks is hard, as we can not capture every possible input of real world in code, writing an algorithm that can recognize a cat from a picture would be an impossible task.

There are however two important aspects of machine learning that make learning algorithms to use in practice, when compared to deterministic ones.
First one is large amount of training data.
In order for machine learning algorithms to learn, they need to be trained on data that will represent actual input that algorithms will receive once they will be deployed in the real world. 
Creating such datasets is usually hard






Today machine learning algorithms are present in many software products that we often use. 
They can be found in email spam detection, Youtube recommendation algorithms, autonomous cars and robots.

